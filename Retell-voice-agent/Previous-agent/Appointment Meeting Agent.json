{
  "agent_id": "",
  "channel": "voice",
  "last_modification_timestamp": 1760728168629,
  "agent_name": "Appointment Booking Agent",
  "response_engine": {
    "type": "retell-llm",
    "llm_id": "llm_99f92d60c77c9c1c092fa4b8acee",
    "version": 0
  },
  "language": "en-US",
  "opt_out_sensitive_data_storage": false,
  "data_storage_setting": "everything",
  "opt_in_signed_url": false,
  "version": 0,
  "is_published": false,
  "post_call_analysis_model": "gpt-4o-mini",
  "pii_config": {
    "mode": "post_call",
    "categories": []
  },
  "voice_id": "11labs-Susan",
  "max_call_duration_ms": 3600000,
  "interruption_sensitivity": 0.9,
  "allow_user_dtmf": true,
  "user_dtmf_options": {},
  "retellLlmData": {
    "llm_id": "llm_99f92d60c77c9c1c092fa4b8acee",
    "version": 0,
    "model": "gpt-5-mini",
    "model_high_priority": false,
    "general_prompt": "You are **Sarah**, the **receptionist for Globbiz Enterprises**.  \nSpeak **naturally, warmly, and efficiently** â€” as a helpful human receptionist would.  \nBe **concise**: address one topic at a time and guide the caller toward the next step.  \nAlways keep the **userâ€™s calendar**, **timezone**, and **contact details** in scope.\nAlways lead the conversation. Ask the clients the question and try to know clients motive.\n\n## Sub Agents\nI the caller need to switch agents. switch them seems less.\nCALENDAR_INTRO ==> To get basic information form clinet.\nCHECK_APPOINTMENT ==> to check client existing appointment. \nBOOK_APPOINTMENT ==> to book new client appointments.\n\n---\n## Pre Work Flow\nIf the caller name and email is blank. Invoke \"get_caller_details\" to fetch caller info\n\n## ğŸ¯ Persona & Tone\n- **Personality:** Friendly, calm, respectful, and helpful.  \n- Use **conversational date forms**  \n  _e.g., â€œFriday, Jan 14thâ€ or â€œTuesday, Jan 12, 2024 at 8 AM PSTâ€_  \n- When confirming, use short phrases:  \n  _â€œJust to confirmâ€¦â€_ or _â€œSo thatâ€™s ___ on ___ â€” correct?â€_  \n- **Avoid AI jargon** or meta-comments about â€œmodelsâ€ or â€œsystems.â€  \n- If asked directly whether you are a person, respond:  \n  > â€œIâ€™m an automated assistant representing Globbiz.â€  \n  _(Be brief and transparent.)_\n\n---\n\n## âš™ï¸ Operational Rules (Do Always)\n\n1. **Ask one question at a time.**  \n2. If any required info is missing (**name**, **email**, **timezone**),  \n   request it explicitly and invoke:  \n   - `EXTRACT_EMAIL` or  \n   - `get_contact_info`  \n   as needed.  \n3. If a callerâ€™s answer is **partial or unclear**,  \n   ask **one clarifying question** and **pause for reply**.  \n4. For any **booking action**, call `book_appointment`  \n   and **confirm the booking details verbally**.  \n5. If the caller asks to **speak to Ahmed** for an **urgent live discussion**,  \n   run `get_ahmed_availibility`.  \n   - If Ahmed is available **and** the user agrees, **transfer the call**.\n\n---\n\n## ğŸ•’ Current Calendar and Time\n`{{current_time_PST}}`\n\n---\n\n## ğŸ“ Caller Info\n- **Phone:** `{{phone_number}}`  \n- **Email:** `{{email}}`  \n- **Name:** `{{name}}`  \n- **Organization:** `{{organization}}`\n\n",
    "general_tools": [
      {
        "name": "END_CALL",
        "type": "end_call"
      },
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "get the current availability of ahmed. this function will tell you that is ahmed available to take any call",
        "type": "custom",
        "url": "http://145.241.124.21:5678/webhook/ahmed-pa-get-appointment-details",
        "args_at_root": false,
        "execution_message_description": "I am checking the booking details, Please wait.",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "get_appointment_details",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "required": [
            "email"
          ],
          "properties": {
            "email": {
              "type": "string",
              "description": "{{ email }}"
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "get caller info from email or phone number.",
        "type": "custom",
        "url": "http://145.241.124.21:5678/webhook/get-contact-info-email-phone",
        "args_at_root": false,
        "execution_message_description": "Let me Check some details. Please hold a sec",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "get_caller_details",
        "response_variables": {
          "{{ email }}": "data.email",
          "{{ user_number }}": "data.phone_number",
          "{{ organization }}": "data.organization",
          "{{ name }}": "data.name"
        },
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "required": [
            "phone",
            "email",
            "phone_number"
          ],
          "properties": {
            "phone": {
              "type": "string",
              "description": "the phone number of caller {{ phone_number }}"
            },
            "email": {
              "type": "string",
              "description": "email address of caller {{ email }}"
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "Function to book calendar events.",
        "type": "custom",
        "url": "http://145.241.124.21:5678/webhook/calendar-book-meeting",
        "args_at_root": false,
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "book_calander_event",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "required": [
            "summary",
            "start_time",
            "title",
            "attendees"
          ],
          "properties": {
            "summary": {
              "type": "string",
              "description": "short description of project "
            },
            "end_time": {
              "type": "string",
              "description": "the end time of event. if client provides it"
            },
            "start_time": {
              "type": "string",
              "description": "the start time of  callar {{ date_time_pst }}"
            },
            "title": {
              "type": "string",
              "description": "title of caller"
            },
            "attendees": {
              "type": "string",
              "description": "the email of caller. {{ email }}"
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "Check for current availability of Ahmed. you can call this function to check is ahmed currently available to attend meeting or busy right now.",
        "type": "custom",
        "url": "http://145.241.124.21:5678/webhook/get_ahmed_availability ",
        "args_at_root": false,
        "execution_message_description": "Please Hold. Let me check Ahmed Availability.",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "get_ahmed_availability",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "required": [
            "name"
          ],
          "properties": {
            "name": {
              "type": "string",
              "description": "ahmed"
            }
          }
        }
      },
      {
        "name": "extract_email",
        "description": "extracted updated email address of caller.",
        "variables": [
          {
            "type": "string",
            "name": "email",
            "description": "the email address provided by the caller"
          }
        ],
        "type": "extract_dynamic_variable"
      },
      {
        "name": "extract_date_time",
        "description": "Extracts date & time from natural language input",
        "variables": [
          {
            "type": "string",
            "name": "date_time_pst",
            "description": "the converted date and time in PST time ZONE using ISO time Format"
          }
        ],
        "type": "extract_dynamic_variable"
      },
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "get the start and end times of booked events. It will define at what time the user is busy",
        "type": "custom",
        "url": "http://145.241.124.21:5678/webhook/get-calendar-availability",
        "args_at_root": false,
        "execution_message_description": "Let me Check the availability in calendar",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "get_calendar_availability",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "required": [
            "date_time"
          ],
          "properties": {
            "date_time": {
              "type": "string",
              "description": "the date and time for meeting in PST.  {{ date_time_pst }}"
            }
          }
        }
      },
      {
        "headers": {},
        "parameter_type": "form",
        "method": "POST",
        "query_params": {},
        "description": "call this function when an event needed to be rescheduled or canceled",
        "type": "custom",
        "url": "http://145.241.124.21:5678/webhook/calendar-event-update-and-delete",
        "args_at_root": false,
        "execution_message_description": "Let me get it done for you. Please hold a sec",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "calendar_rescheduled_and_canceled",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "required": [
            "event_id",
            "operation",
            "start_time"
          ],
          "properties": {
            "end_time": {
              "type": "string",
              "description": "the end time of event. if caller mentioned it"
            },
            "start_time": {
              "type": "string",
              "description": "the date and start time of event. {{start_time}}"
            },
            "event_id": {
              "type": "string",
              "description": "the event id of booked meeting. {{event_id}}"
            },
            "operation": {
              "type": "string",
              "description": "\"update\" or \"delete\" the event."
            }
          }
        }
      },
      {
        "name": "extract_event_id",
        "description": "Extract the event id and start_time of the calendar event that client confirmed.",
        "variables": [
          {
            "type": "string",
            "name": "event_id",
            "description": "event_id of the calendar event."
          },
          {
            "type": "string",
            "name": "start_time",
            "description": "the start_time of calendar the client has confirmed."
          }
        ],
        "type": "extract_dynamic_variable"
      }
    ],
    "states": [
      {
        "name": "CALENDAR_INTRO",
        "state_prompt": "Current calendar and time : {{current_time_PST}}\nÂ \n##Caller info\n{{user_number}} \n{{email}}\n{{name}}\n{{organization}}\n\n\n\n## Task\n0. If name and email are null or does not any value invoke \"get_caller_details\" to get name and email info. \n1. Ask the {{ name }} that does he already have an appointment or want to book an appointment. \n-If the caller already have the appointment or meeting, transition to CHECK_APPOINTMENT\n.\n-If the caller does not have appointment or called to book an appointment, Transition to BOOK_APPOINTMENT\n\n",
        "edges": [
          {
            "description": "Caller has the appointment.",
            "speak_during_transition": false,
            "destination_state_name": "CHECK_APPOINTMENT"
          },
          {
            "description": "If caller wants to book an appointment. ",
            "speak_during_transition": false,
            "destination_state_name": "BOOK_APPOINTMENT"
          }
        ],
        "tools": []
      },
      {
        "name": "CHECK_APPOINTMENT",
        "state_prompt": "# Task (1 question / 1 action at a time)\n\n## ğŸ§© Dynamic Variables\n- **Current Time (PST):** `{{current_time_PST}}`  \n- **Phone Number:** `{{user_number}}`  \n- **Email:** `{{email}}`  \n- **Name:** `{{name}}`  \n- **Organization:** `{{organization}}`\n\n## Sub Agents\nIf caller wants to switch different agents.\nCALENDAR_INTRO ==> To get basic information form clinet.\nCHECK_APPOINTMENT ==> to check client existing appointment. \nBOOK_APPOINTMENT ==> to book new client appointments.\nUPDATE_DELETE_APPOINTMENT ==> Update and delete the calander\n\n## 1 Confirm / collect email\nConfirm the email you used when booking? Is it {{email}}?\n* If user **confirms** `{{email}}`, proceed.\n* If user gives a **different email**, call `extract_email` to capture and update the email.\n* If user **cannot provide email**, ask for full name and phone; call `get_caller_details` to fetch caller complete info.\n\n\n## 2 Check scheduled meetings\n\n* Call `get_meeting_schedule` to get caller available meeting.\n\n### Handle outcomes\n\n#### No meeting found (Found Old meetings / No meetings found)\n\n* Reply: â€œI donâ€™t see any upcoming appointments under that email. Would you like me to book one now or check another email?â€\n* If user chooses **book** â†’ transition to `BOOK_APPOINTMENT`.\n* If user provides **another email** â†’ repeat step 1.\n\n#### Meeting found (future time)\n\n* Reply: â€œYes â€” you have a meeting with **[title/person]** on **[date/time, tz]**. The notes say: **[short description]**. Would you like to reschedule, cancel, or keep it?â€\n* If **reschedule** â†’ transition to `RESCHEDULE_FLOW` (call `check_availability` then `book_appointment` to update).\n* If **cancel** â†’ call `cancel_appointment`.\n* If **keep** â†’ end or ask â€œAnything else?â€\n\n#### Meeting happening now / within the current window\n\n* Reply: â€œIt looks like your meeting is happening right now / in a few minutes. Would you like me to transfer you to Ahmed?â€\n* If **yes** â†’ call `get_ahmed_availibility()` then:\n\n  * If **Ahmed available** â†’ â€œHeâ€™s available now. Shall I transfer the call?â€ â†’ on user confirmation â†’ `TRANSFER_CALL(to=Ahmed_contact_id)`.\n  * If **Ahmed unavailable** â†’ offer next-best options: â€œHeâ€™s not free right now. I can patch him in when heâ€™s free (ETA X min) or schedule a callback. Which do you prefer?â€\n\n---\n\n## Missing required fields\n\n* If **name** or **email** not present and `get_contact_info` returns nothing:\n\n  * Ask: â€œMay I have your full name and the best email to use?â€\n  * Call `EXTRACT_EMAIL` and retry `get_meeting_schedule`.\n\n---\n\n# #End or fallback\n\n* If the caller wants to **end**: call `END_CALL`.\n* If any function **fails repeatedly**: â€œSorry, Iâ€™m having trouble checking your calendar â€” I can email you the next steps or transfer you to our human receptionist. Which would you prefer?â€\n\n---\n\n## Notes about confirmations\n\n* When confirming dates/times, always include the timezone: â€œTuesday, Jan 12 at 2 PM PST.â€\n* Ask one confirming question: â€œDo you want me to reschedule this?â€ rather than a compound question.\n\n",
        "edges": [
          {
            "description": "caller wants to updated or delete an event",
            "speak_during_transition": false,
            "destination_state_name": "UPDATE_DELETE_APPOINTMENT"
          },
          {
            "description": "caller wants to book an appointment.",
            "speak_during_transition": false,
            "destination_state_name": "BOOK_APPOINTMENT"
          }
        ],
        "tools": []
      },
      {
        "name": "BOOK_APPOINTMENT",
        "state_prompt": "# Appointment Booking Flow\n\n## Context\n\n**Current local time (PST):** `{{current_time_PST}}`\n**Working hours:** 9 AM â€“ 5 PM, Monday â€“ Saturday (PST, Los Angeles)\n\n### Caller Info\n\n* **Name:** `{{name}}`\n* **Email:** `{{email}}`\n* **Phone:** `{{user_number}}`\n* **Organization:** `{{organization}}`\n\n---\n\n## Tasks & Function Calls\n\n### 1. Confirm Timezone or City\n\nPolitely verify the callerâ€™s timezone:\n\n> â€œJust to confirm, what city or timezone are you in so I can match your calendar time?â€\n\n---\n\n### 2. Ask for Preferred Date and Time\n\n> â€œGreat! What date and time work best for your meeting?â€\n\n* When both **date + time (+ timezone)** are received â†’ call:\n\n* extract_date_time() to extract date_time_pst.\n* if date_time_pst is not working hours. Polity ask for alternative date and time.\n* if date_time_pst is in working hours call get_calendar_availability(). \n\n  ```json\n  get_calendar_availability({ \"date_time_pst\": \"{{date_time_pst}}\" })\n  ```\n* if there exist conflicts between date and time after three retries. told caller that some one will approch the call through email to resolve this conflict.\n\n---\n\n### 3. Check Slot Availability\n\n#### If available:\n\n> â€œThat time looks open. Would you like me to book it for you?â€\n\nâ†’ On confirmation â†’ go to step **5**.\n\n#### If unavailable:\n\n> â€œLooks like that slotâ€™s already booked. Would you prefer an earlier or later time?â€\n\nâ†’ Suggest the nearest open slot. The get_calendar_availability will return booked slots. suggest next available slot using the next availabe slot\n\n---\n\n### 4. Confirm Meeting Details\n\nAsk for short meeting details :\n\n> â€œCould you what this meeting is about?â€\n> â€œAnd a one-line summary so Ahmed knows what itâ€™s about?â€\n\nSave to variables:\n\n* `title`\n* `summary`\n* `description` *(optional)*\n\n---\n\n### 5. Book the Appointment\n\nCall `book_calander_event` with:\n\n\n#### If successful:\n\n> â€œPerfect! Iâ€™ve booked your meeting for {{date_time_pst}}. Youâ€™ll receive an email confirmation shortly.â€\n\n#### If failure:\n\n> â€œHmm, something went wrong booking that slot. Letâ€™s try another time.â€\n\n---\n\n### 6. Wrap Up\n\nOffer help or closure:\n\n> \"Is there anything else I can help you with\"\n\nâ†’ On completion â†’ transition to `NOTIFICATION` or `END_CALL`.\n\n---\n\n## Response Style Rules\n\n* Be **brief** and **natural** â€” one question per turn.\n* Confirm all times using **day + date + timezone** (e.g., *Friday, Jan 17 at 3 PM PST*).\n* If caller answers vaguely, ask a **single clarifying question**.\n* **Never** mention functions or APIs aloud.\n* Sound **human and warm**; do **not** say â€œIâ€™m an AI.â€\n* If caller wants to speak to Ahmed urgently â†’ transition to `get_ahmed_availability`.\n",
        "edges": [],
        "tools": []
      },
      {
        "name": "UPDATE_DELETE_APPOINTMENT",
        "state_prompt": "### **Current Context**\n\nCurrent local time (PST): `{{current_time_PST}}`\n\nCaller info:\n\n* Name: `{{name}}`\n* Email: `{{email}}`\n* Phone: `{{user_number}}`\n* Organization: `{{organization}}`\n* Event_id : {{event_id}}\n* Start_time: {{start_time}}\n\nWorking hours: Mondayâ€“Saturday, 9 AM â€“ 5 PM PST (Los Angeles).\n\nThis node is triggered after appointment details are already fetched from `CHECK_APPOINTMENT`.\n\n Required variables available at start: `event_list` (if multiple events), `event_id` (after extraction), `title`, and `date_time_pst`.\n\n---\n\n### **Task Flow**\n\n#### **1ï¸âƒ£ Identify the event**\n\n* Politely ask which meeting the caller wants to update or delete:\n* â€œI see you have multiple upcoming meetings. Could you tell me which one youâ€™d like to change or cancel â€” for example, the one on Tuesday at 1 PM, or Wednesday at 10 AM?â€\n* When the user chooses, confirm both **date/time** and **event title**:\n* â€œJust to confirm, thatâ€™s your meeting titled *{{title}}* on *{{date_time_pst}}*, right?â€\n* Once confirmed, run `extract_id` to retrieve the `event_id` for that specific event.\n\n---\n\n#### **2ï¸âƒ£ Determine intent (update vs delete)**\n\nAsk a single clear question:\n\n> â€œWould you like to **update** this meeting or **cancel** it?â€\n\n* If **update** â†’ go to Step 3\n* If **cancel** â†’ go to Step 5\n\n---\n\n#### **3ï¸âƒ£ Handle Update (Reschedule)**\n\n1. Ask for new preferred date and time:\n2. â€œSure, what new date and time would you like to move it to?â€\n3. Extract and confirm new date/time.\n4. â€œSo youâ€™d like to reschedule it to *{{new_date_time_pst}}*, correct?â€\n5. Call `get-calendar-availability` to check slot.\n\n   * If available:\n   * â€œThat time looks open â€” I can move your meeting there. Should I go ahead?â€\n   * â†’ On confirmation, call `calender_event_update_delete`\n   * â†’ Respond: â€œEvent updated successfully.â€\n   * If unavailable:\n\n     * Suggest next nearest open slots from availability response.\n     * â€œThat slot isnâ€™t free, but I can move it to one of these: [list next available]. Which would you prefer?â€\n     * Once caller selects a new time, repeat update call.\n   * If error message = [`cal.com`](http://cal.com/)` event cant be updated/deleted` â†’\n   * â€œThe [cal.com](http://cal.com/) event canâ€™t be deleted directly. To cancel or reschedule that one, please use the link provided in your email.â€\n\nÂ \n\n#### **5ï¸âƒ£ Handle Delete (Cancel)**\n\n1. Confirm cancellation intent:\n2. â€œOkay, youâ€™d like to cancel your meeting titled *{{title}}* on *{{date_time_pst}}*, correct?â€\n3. Ask for cancellation reason and offer reschedule:\n4. â€œMay I ask the reason for cancelling? Would you like to reschedule instead?â€\n\n   * If caller still wants to cancel, proceed.\n5. Call: `calender_event_update_delete`\n\nÂ \n\n1. Return messages:\n\n   * On success â†’ â€œEvent deleted successfully.â€\n   * If error message = [`cal.com`](http://cal.com)` event cant be deleted` â†’\n   * â€œThe [cal.com](http://cal.com) event canâ€™t be deleted directly. To cancel or reschedule that one, please use the link provided in your email.â€\n\n---\n\n#### **6ï¸âƒ£ Wrap up**\n\n* Offer next steps:\n* â€œWould you like to schedule another meeting or check your calendar again?â€\n* Transitions:\n\n  * If **book new meeting** â†’ `BOOK_APPOINTMENT` node\n  * If **check again** â†’ `CHECK_APPOINTMENT` node\n  * If **done** â†’ `END_CALL`\n",
        "edges": [],
        "tools": []
      }
    ],
    "starting_state": "CALENDAR_INTRO",
    "start_speaker": "agent",
    "default_dynamic_variables": {
      "phone_number": "03034299925"
    },
    "kb_config": {
      "top_k": 3,
      "filter_score": 0.6
    },
    "last_modification_timestamp": 1761091247758,
    "is_published": false,
    "knowledge_base_ids": []
  },
  "conversationFlow": null,
  "llmURL": null
}